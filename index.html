<html lang="en-US"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Plato Dropbox</title>
  </head>
  
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
  
      <h1>Plato dropbox fetcher</h1>
      <p>Paste the following command in your terminal (click to copy):</p>
      <code id="command" onclick="copy()">curl -s https://api.dropbox.com/oauth2/token -d grant_type=authorization_code -d client_id=qv00v86kfe5d2j2 -d redirect_uri=https://plato-dropbox.truongnq.dev -d code_verifier=0000000000000000000000000000000000000000000 -d code=null | sed 's/.*"refresh_token": "\([^"]*\)", ".*/\nAdd this line to your Settings file:\n\ndropbox-token = qv00v86kfe5d2j2:\1\n\n/'</code>
      <p>Then add the line starting with <code>dropbox-token = </code> to your Settings file.</p>
    </div>
  
  
  
  
  <style>
    div {
      margin: auto;
      max-width: 50%;
    }
  </style>
  <script>
    let url = "https://plato-dropbox.truongnq.dev" //window.location.origin + window.location.pathname;
    let client_id = "qv00v86kfe5d2j2";
    let code = new URLSearchParams(
      window.location.search.substr(1) // skip the first char (#)
    ).get('code')
    let out = document.getElementById("command")
    let command = `curl -s https://api.dropbox.com/oauth2/token \
  -d grant_type=authorization_code \
  -d client_id=${client_id} \
  -d redirect_uri=${url} \
  -d code_verifier=0000000000000000000000000000000000000000000 \
  -d code=${code} | sed 's/.*"refresh_token": "\\([^"]*\\)", ".*/\\n\
  Add this line to your Settings file:\\n\\ndropbox-token = "${client_id}:\\1"\\n\\n/'`;
  
    out.innerText = command;
    let copy = () => {
      navigator.clipboard.writeText(out.innerText);
      let alert = document.createElement("p");
      alert.innerHTML = "Copied!"
      out.parentNode.insertBefore(alert, out.nextSibling);
      setTimeout(() => {
        alert.parentNode.removeChild(alert);
      }, 1000);
    }
  </script></body></html>